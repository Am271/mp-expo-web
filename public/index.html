<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Leaflet demo</title>
	<!-- link for leaflet -->
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
		integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />

	<link rel="stylesheet" type="text/css" href="./styles.css" />

	<link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
</head>

<body>
	<script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
		integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin="">
		</script>
	<div id="map"></div>
	<script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

	<script type="text/javascript">
		var map = L.map('map').setView([12.887802, 77.6432018], 13);
		// L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
		// 	maxZoom: 19,
		// 	attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
		// }).addTo(map);

		L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
			maxZoom: 51,
			subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
		}).addTo(map);

		L.Control.geocoder().addTo(map);

		if (!navigator.geolocation) {
			console.log("Your browser doesn't support geolocation feature!");
		} else {
			// navigator.geolocation.getCurrentPosition(getPosition);
			setInterval(() => {
				navigator.geolocation.getCurrentPosition(getPosition)
			}, 5000);

			console.log(" geolocation works");
		}

		var marker, circle, lat, long, accuracy;

		function getPosition(position) {
			// console.log(position)
			lat = position.coords.latitude
			long = position.coords.longitude
			accuracy = position.coords.accuracy

			if (marker) {
				map.removeLayer(marker)
			}

			if (circle) {
				map.removeLayer(circle)
			}

			marker = L.marker([lat, long])
			circle = L.circle([lat, long], { radius: accuracy })

			var featureGroup = L.featureGroup([marker, circle]).addTo(map)

			map.fitBounds(featureGroup.getBounds())

			console.log("Your coordinate is: Lat: " + lat + " Long: " + long + " Accuracy: " + accuracy)
		}

	</script>
</body>

</html>